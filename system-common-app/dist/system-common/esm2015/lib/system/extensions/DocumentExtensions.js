/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
Document.prototype.SelectOne = function (selector) {
    return document.querySelector(selector);
};
Document.prototype.SelectAll = function (selector) {
    return document.querySelectorAll(selector);
};
Document.prototype.Create = function (html) {
    /** @type {?} */
    let placeholder = document.createElement('div');
    placeholder.innerHTML = html;
    return /** @type {?} */ (placeholder.childNodes[0]);
};
NodeList.prototype.ForEach = function (callback) {
    for (let i = 0; i < this.length; i++) {
        callback(i, this[i]);
    }
};
NodeList.prototype.Last = function () {
    return this[this.length - 1];
};
Element.prototype.SelectOne = function (selector) {
    return this.querySelector(selector);
};
Element.prototype.SelectAll = function (selector) {
    return this.querySelectorAll(selector);
};
Element.prototype.Attribute = function (name, value) {
    if (value != null) {
        this.setAttribute(name, value);
        return this;
    }
    return this.getAttribute(name);
};
Element.prototype.Parent = function () {
    return this.parentNode;
};
Element.prototype.HasMatches = function (selector) {
    if ((/** @type {?} */ (this)).matches != null) {
        return (/** @type {?} */ (this)).matches(selector);
    }
    else if ((/** @type {?} */ (this)).msMatchesSelector != null) {
        return (/** @type {?} */ (this)).msMatchesSelector(selector);
    }
    return false;
};
Element.prototype.Up = function (selector) {
    /** @type {?} */
    let el = this;
    if ((/** @type {?} */ (el)).closest != null) {
        return (/** @type {?} */ (el)).closest(selector);
    }
    else {
        while (el) {
            if (el.HasMatches(selector)) {
                return /** @type {?} */ (el);
            }
            el = el.parentElement;
        }
    }
};
Element.prototype.First = function (selector) {
    /**
     * @param {?} node
     * @return {?}
     */
    function _decend(node) {
        /** @type {?} */
        let _currentNode = node;
        /** @type {?} */
        let nodeList = _currentNode.childNodes;
        for (let i = 0; i < nodeList.length; i++) {
            if (nodeList[i].nodeName.ToLower() === selector.ToLower()) {
                return /** @type {?} */ (nodeList[i]);
            }
        }
        _decend(_currentNode);
    }
    return _decend(this);
};
Element.prototype.Append = function (html) {
    this.insertAdjacentHTML('beforeend', html);
    return this;
};
Element.prototype.Empty = function () {
    this.innerHTML = '';
    return this;
};
Element.prototype.Drop = function () {
    /** @type {?} */
    let self = this;
    /** @type {?} */
    let parent = self.parentNode;
    parent.removeChild(self);
    return self;
};
Element.prototype.RemoveEvent = function (event) {
    /** @type {?} */
    let evt = this[`on${event}`] || this[`${event}`];
    try {
        this.removeEventListener(event, evt);
    }
    catch (e) { }
    try {
        this.detachEvent(`on${event}`, evt);
    }
    catch (e) { }
    this[`on${event}`] = null;
    this[`${event}`] = null;
    return this;
};
Element.prototype.AddEvent = function (event, callback, overwrite = false) {
    if (overwrite) {
        this[`on${event}`] = callback;
    }
    else {
        this.addEventListener(event, callback);
    }
    return this;
};
Element.prototype.Show = function (t = 'block') {
    /** @type {?} */
    let styles = this.attribute('style');
    if (styles != null && styles !== '') {
        return this.attribute('style', styles.setValueByKey('display', t));
    }
    return this.attribute('style', `display:${t}`);
};
Element.prototype.Hide = function () {
    /** @type {?} */
    let styles = this.attribute('style');
    if (styles != null && styles !== '') {
        return this.attribute('style', styles.setValueByKey('display', 'none'));
    }
    return this.attribute('style', `display:none;`);
};
Element.prototype.Toggle = function () {
    if (!(this.offsetWidth || this.offsetHeight || this.getClientRects().length)) {
        return this.show();
    }
    else {
        return this.hide();
    }
};
Element.prototype.AddClass = function (className) {
    this.className += ` ${className}`;
    this.className = this.className.trim();
    return this;
};
Element.prototype.RemoveClass = function (className) {
    this.className = (/** @type {?} */ (this.className)).replace(className, '').normalize();
    return this;
};
Element.prototype.AsString = function () {
    return this.outerHTML;
};
Element.prototype.IsHidden = function () {
    return (this.offsetParent === null);
};
HTMLElement.prototype.Clean = function () {
    this.value = this.value.replace(/\r?\n/g, '\r\n');
    return this;
};
HTMLElement.prototype.Value = function (val) {
    if (val != null) {
        if (this.nodeName.lower() === 'textarea') {
            this.innerHTML = val;
            try {
                this.innerText = val;
            }
            catch (e) { }
            try {
                this.value = val;
            }
            catch (e) { }
        }
        else if (this.nodeName.lower() === 'input') {
            switch (this.attribute('type').lower()) {
                case 'file':
                    break;
                case 'checkbox':
                    if (/** @type {?} */ (/** @type {?} */ (val))) {
                        this.checked = true;
                    }
                    else {
                        this.checked = false;
                    }
                    break;
                case 'radio':
                    /** @type {?} */
                    let name = this.attribute('name');
                    /** @type {?} */
                    let radios = document.SelectAll(`input[type='radio'][name='${name}']`);
                    radios.ForEach(function (idx, elem) {
                        if (elem.Attribute('value') === val) {
                            (/** @type {?} */ (elem)).checked = true;
                        }
                        else {
                            (/** @type {?} */ (elem)).checked = false;
                        }
                    });
                    break;
                default:
                    this.value = val;
                    break;
            }
        }
        else if (this.nodeName.lower() === 'select') {
            for (let i = 0; i < this.options.length; i++) {
                if (this.options[i].value === val) {
                    this.selectedIndex = i;
                    break;
                }
            }
        }
    }
    else {
        if (this.nodeName.lower() === 'textarea') {
            try {
                return this.value;
            }
            catch (e) { }
            if (this.innerText != null && (/** @type {?} */ (this.innerText)).trim() !== '') {
                return this.innerText;
            }
            else if (this.innerHTML != null && (/** @type {?} */ (this.innerHTML)).trim() !== '') {
                return this.innerHTML;
            }
            return null;
        }
        else if (this.nodeName.lower() === 'input') {
            switch (this.attribute('type').lower()) {
                case 'checkbox':
                    return this.checked;
                case 'radio':
                    /** @type {?} */
                    let name = this.attribute('name');
                    return (/** @type {?} */ (document.SelectOne(`input[type='radio'][name='${name}']:checked`))).value;
                default:
                    return this.value;
            }
        }
        else if (this.nodeName.lower() === 'select') {
            return this.options[this.selectedIndex].value;
        }
    }
    return val;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRG9jdW1lbnRFeHRlbnNpb25zLmpzIiwic291cmNlUm9vdCI6Im5nOi8veWFmZXlhLXN5c3RlbS1jb21tb24vIiwic291cmNlcyI6WyJsaWIvc3lzdGVtL2V4dGVuc2lvbnMvRG9jdW1lbnRFeHRlbnNpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUF3Q0EsUUFBUSxDQUFDLFNBQVMsQ0FBQyxTQUFTLEdBQUcsVUFBVSxRQUFnQjtJQUNyRCxPQUFPLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7Q0FDM0MsQ0FBQztBQUVGLFFBQVEsQ0FBQyxTQUFTLENBQUMsU0FBUyxHQUFHLFVBQVUsUUFBZ0I7SUFDckQsT0FBTyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUM7Q0FDOUMsQ0FBQztBQUVGLFFBQVEsQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLFVBQVUsSUFBWTs7SUFDOUMsSUFBSSxXQUFXLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNoRCxXQUFXLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztJQUM3Qix5QkFBZ0IsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBQztDQUM3QyxDQUFDO0FBRUYsUUFBUSxDQUFDLFNBQVMsQ0FBQyxPQUFPLEdBQUcsVUFBVSxRQUFrQjtJQUNyRCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUNsQyxRQUFRLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3hCO0NBQ0osQ0FBQztBQUVGLFFBQVEsQ0FBQyxTQUFTLENBQUMsSUFBSSxHQUFHO0lBQ3RCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7Q0FDaEMsQ0FBQztBQUVGLE9BQU8sQ0FBQyxTQUFTLENB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bUJBQW1CLFFBQVEsQ0FBQyxTQUFTLENBQUMsNkJBQTZCLElBQUksWUFBWSxDQUFDLEVBQUMsQ0FBQyxLQUFLLENBQUM7Z0JBQ3ZHO29CQUNJLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQzthQUN6QjtTQUNKO2FBQU0sSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxLQUFLLFFBQVEsRUFBRTtZQUMzQyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLEtBQUssQ0FBQztTQUNqRDtLQUNKO0lBQ0QsT0FBTyxHQUFHLENBQUM7Q0FDZCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW50ZXJmYWNlIERvY3VtZW50IHtcclxuICAgIFNlbGVjdE9uZTogKHNlbGVjdG9yOiBzdHJpbmcpID0+IEVsZW1lbnQ7XHJcbiAgICBTZWxlY3RBbGw6IChzZWxlY3Rvcjogc3RyaW5nKSA9PiBOb2RlTGlzdE9mPEVsZW1lbnQ+O1xyXG4gICAgQ3JlYXRlOiAoaHRtbDogc3RyaW5nKSA9PiBFbGVtZW50O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTm9kZUxpc3Qge1xyXG4gICAgRm9yRWFjaDogKGNhbGxiYWNrOiBGdW5jdGlvbikgPT4gdm9pZDtcclxuICAgIExhc3Q6ICgpID0+IEVsZW1lbnQ7XHJcbn1cclxuXHJcbmludGVyZmFjZSBFbGVtZW50IHtcclxuICAgIEF0dHJpYnV0ZTogKG5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcpID0+IHN0cmluZyAmIEVsZW1lbnQ7XHJcbiAgICBQYXJlbnQ6ICgpID0+IEVsZW1lbnQ7XHJcbiAgICBGaXJzdDogKHNlbGVjdG9yOiBzdHJpbmcpID0+IEVsZW1lbnQ7XHJcbiAgICBBcHBlbmQ6IChodG1sOiBzdHJpbmcpID0+IEVsZW1lbnQ7XHJcbiAgICBFbXB0eTogKCkgPT4gRWxlbWVudDtcclxuICAgIERyb3A6ICgpID0+IEVsZW1lbnQ7XHJcbiAgICBSZW1vdmVFdmVudDogKGV2ZW50OiBzdHJpbmcpID0+IEVsZW1lbnQ7XHJcbiAgICBBZGRFdmVudDogKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbiwgb3ZlcndyaXRlPzogYm9vbGVhbikgPT4gRWxlbWVudDtcclxuICAgIFNob3c6ICh0Pzogc3RyaW5nKSA9PiBFbGVtZW50O1xyXG4gICAgSGlkZTogKCkgPT4gRWxlbWVudDtcclxuICAgIFRvZ2dsZTogKCkgPT4gRWxlbWVudDtcclxuICAgIEFkZENsYXNzOiAoY2xhc3NOYW1lOiBzdHJpbmcpID0+IEVsZW1lbnQ7XHJcbiAgICBSZW1vdmVDbGFzczogKGNsYXNzTmFtZTogc3RyaW5nKSA9PiBFbGVtZW50O1xyXG4gICAgQXNTdHJpbmc6ICgpID0+IHN0cmluZztcclxuICAgIFNlbGVjdE9uZTogKHNlbGVjdG9yOiBzdHJpbmcpID0+IEVsZW1lbnQ7XHJcbiAgICBTZWxlY3RBbGw6IChzZWxlY3Rvcjogc3RyaW5nKSA9PiBOb2RlTGlzdE9mPEVsZW1lbnQ+O1xyXG4gICAgSGFzTWF0Y2hlczogKHNlbGVjdG9yOiBzdHJpbmcpID0+IGJvb2xlYW47XHJcbiAgICBVcDogKHNlbGVjdG9yOiBzdHJpbmcpID0+IEVsZW1lbnQ7XHJcbiAgICBJc0hpZGRlbjogKCkgPT4gQm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIEhUTUxFbGVtZW50IHtcclxuICAgIENsZWFuOiAoKSA9PiBIVE1MRWxlbWVudDtcclxuICAgIFZhbHVlOiAodmFsPzogc3RyaW5nKSA9PiBzdHJpbmc7XHJcbn1cclxuXHJcblxyXG5cclxuRG9jdW1lbnQucHJvdG90eXBlLlNlbGVjdE9uZSA9IGZ1bmN0aW9uIChzZWxlY3Rvcjogc3RyaW5nKTogRWxlbWVudCB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbn07XHJcblxyXG5Eb2N1bWVudC5wcm90b3R5cGUuU2VsZWN0QWxsID0gZnVuY3Rpb24gKHNlbGVjdG9yOiBzdHJpbmcpOiBOb2RlTGlzdE9mPEVsZW1lbnQ+IHtcclxuICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcclxufTtcclxuXHJcbkRvY3VtZW50LnByb3RvdHlwZS5DcmVhdGUgPSBmdW5jdGlvbiAoaHRtbDogc3RyaW5nKTogRWxlbWVudCB7XHJcbiAgICBsZXQgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHBsYWNlaG9sZGVyLmlubmVySFRNTCA9IGh0bWw7XHJcbiAgICByZXR1cm4gPEVsZW1lbnQ+cGxhY2Vob2xkZXIuY2hpbGROb2Rlc1swXTtcclxufTtcclxuXHJcbk5vZGVMaXN0LnByb3RvdHlwZS5Gb3JFYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrOiBGdW5jdGlvbik6IHZvaWQge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY2FsbGJhY2soaSwgdGhpc1tpXSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5Ob2RlTGlzdC5wcm90b3R5cGUuTGFzdCA9IGZ1bmN0aW9uICgpOiBFbGVtZW50IHtcclxuICAgIHJldHVybiB0aGlzW3RoaXMubGVuZ3RoIC0gMV07XHJcbn07XHJcblxyXG5FbGVtZW50LnByb3RvdHlwZS5TZWxlY3RPbmUgPSBmdW5jdGlvbiAoc2VsZWN0b3I6IHN0cmluZyk6IEVsZW1lbnQge1xyXG4gICAgcmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbn07XHJcblxyXG5FbGVtZW50LnByb3RvdHlwZS5TZWxlY3RBbGwgPSBmdW5jdGlvbiAoc2VsZWN0b3I6IHN0cmluZyk6IE5vZGVMaXN0T2Y8RWxlbWVudD4ge1xyXG4gICAgcmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XHJcbn07XHJcblxyXG5FbGVtZW50LnByb3RvdHlwZS5BdHRyaWJ1dGUgPSBmdW5jdGlvbiAobmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZyk6IHN0cmluZyAmIEVsZW1lbnQge1xyXG4gICAgaWYgKHZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUobmFtZSk7XHJcbn07XHJcblxyXG5FbGVtZW50LnByb3RvdHlwZS5QYXJlbnQgPSBmdW5jdGlvbiAoKTogRWxlbWVudCB7XHJcbiAgICByZXR1cm4gdGhpcy5wYXJlbnROb2RlO1xyXG59O1xyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuSGFzTWF0Y2hlcyA9IGZ1bmN0aW9uIChzZWxlY3Rvcjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBpZiAoKDxhbnk+dGhpcykubWF0Y2hlcyAhPSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuICg8YW55PnRoaXMpLm1hdGNoZXMoc2VsZWN0b3IpO1xyXG4gICAgfSBlbHNlIGlmICgoPGFueT50aGlzKS5tc01hdGNoZXNTZWxlY3RvciAhPSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuICg8YW55PnRoaXMpLm1zTWF0Y2hlc1NlbGVjdG9yKHNlbGVjdG9yKTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbkVsZW1lbnQucHJvdG90eXBlLlVwID0gZnVuY3Rpb24gKHNlbGVjdG9yOiBzdHJpbmcpOiBFbGVtZW50IHtcclxuICAgIGxldCBlbDogRWxlbWVudCA9IHRoaXM7XHJcbiAgICBpZiAoKDxhbnk+ZWwpLmNsb3Nlc3QgIT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiAoPGFueT5lbCkuY2xvc2VzdChzZWxlY3Rvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHdoaWxlIChlbCkge1xyXG4gICAgICAgICAgICBpZiAoZWwuSGFzTWF0Y2hlcyhzZWxlY3RvcikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiA8RWxlbWVudD5lbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbCA9IGVsLnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuRmlyc3QgPSBmdW5jdGlvbiAoc2VsZWN0b3I6IHN0cmluZyk6IEVsZW1lbnQge1xyXG4gICAgZnVuY3Rpb24gX2RlY2VuZChub2RlOiBFbGVtZW50KTogRWxlbWVudCB7XHJcbiAgICAgICAgbGV0IF9jdXJyZW50Tm9kZSA9IG5vZGU7XHJcbiAgICAgICAgbGV0IG5vZGVMaXN0OiBOb2RlTGlzdCA9IF9jdXJyZW50Tm9kZS5jaGlsZE5vZGVzO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZUxpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKG5vZGVMaXN0W2ldLm5vZGVOYW1lLlRvTG93ZXIoKSA9PT0gc2VsZWN0b3IuVG9Mb3dlcigpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gPEVsZW1lbnQ+bm9kZUxpc3RbaV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgX2RlY2VuZChfY3VycmVudE5vZGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9kZWNlbmQodGhpcyk7XHJcbn07XHJcblxyXG5FbGVtZW50LnByb3RvdHlwZS5BcHBlbmQgPSBmdW5jdGlvbiAoaHRtbDogc3RyaW5nKTogRWxlbWVudCB7XHJcbiAgICB0aGlzLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgaHRtbCk7XHJcbiAgICByZXR1cm4gdGhpcztcclxufTtcclxuXHJcbkVsZW1lbnQucHJvdG90eXBlLkVtcHR5ID0gZnVuY3Rpb24gKCk6IEVsZW1lbnQge1xyXG4gICAgdGhpcy5pbm5lckhUTUwgPSAnJztcclxuICAgIHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuRHJvcCA9IGZ1bmN0aW9uICgpOiBFbGVtZW50IHtcclxuICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgIGxldCBwYXJlbnQgPSBzZWxmLnBhcmVudE5vZGU7XHJcbiAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoc2VsZik7XHJcbiAgICByZXR1cm4gc2VsZjtcclxufTtcclxuXHJcbkVsZW1lbnQucHJvdG90eXBlLlJlbW92ZUV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50OiBzdHJpbmcpOiBFbGVtZW50IHtcclxuICAgIGxldCBldnQgPSB0aGlzW2BvbiR7ZXZlbnR9YF0gfHwgdGhpc1tgJHtldmVudH1gXTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBldnQpO1xyXG4gICAgfSBjYXRjaCAoZSkgeyB9XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHRoaXMuZGV0YWNoRXZlbnQoYG9uJHtldmVudH1gLCBldnQpO1xyXG4gICAgfSBjYXRjaCAoZSkgeyB9XHJcbiAgICB0aGlzW2BvbiR7ZXZlbnR9YF0gPSBudWxsO1xyXG4gICAgdGhpc1tgJHtldmVudH1gXSA9IG51bGw7XHJcbiAgICByZXR1cm4gdGhpcztcclxufTtcclxuXHJcbkVsZW1lbnQucHJvdG90eXBlLkFkZEV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbiwgb3ZlcndyaXRlOiBib29sZWFuID0gZmFsc2UpOiBFbGVtZW50IHtcclxuICAgIGlmIChvdmVyd3JpdGUpIHtcclxuICAgICAgICB0aGlzW2BvbiR7ZXZlbnR9YF0gPSBjYWxsYmFjaztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBjYWxsYmFjayk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcztcclxufTtcclxuXHJcbkVsZW1lbnQucHJvdG90eXBlLlNob3cgPSBmdW5jdGlvbiAodDogc3RyaW5nID0gJ2Jsb2NrJyk6IEVsZW1lbnQge1xyXG4gICAgbGV0IHN0eWxlcyA9IHRoaXMuYXR0cmlidXRlKCdzdHlsZScpO1xyXG4gICAgaWYgKHN0eWxlcyAhPSBudWxsICYmIHN0eWxlcyAhPT0gJycpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGUoJ3N0eWxlJywgc3R5bGVzLnNldFZhbHVlQnlLZXkoJ2Rpc3BsYXknLCB0KSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGUoJ3N0eWxlJywgYGRpc3BsYXk6JHt0fWApO1xyXG59O1xyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuSGlkZSA9IGZ1bmN0aW9uICgpOiBFbGVtZW50IHtcclxuICAgIGxldCBzdHlsZXMgPSB0aGlzLmF0dHJpYnV0ZSgnc3R5bGUnKTtcclxuICAgIGlmIChzdHlsZXMgIT0gbnVsbCAmJiBzdHlsZXMgIT09ICcnKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cmlidXRlKCdzdHlsZScsIHN0eWxlcy5zZXRWYWx1ZUJ5S2V5KCdkaXNwbGF5JywgJ25vbmUnKSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5hdHRyaWJ1dGUoJ3N0eWxlJywgYGRpc3BsYXk6bm9uZTtgKTtcclxufTtcclxuRWxlbWVudC5wcm90b3R5cGUuVG9nZ2xlID0gZnVuY3Rpb24gKCk6IEVsZW1lbnQge1xyXG4gICAgaWYgKCEodGhpcy5vZmZzZXRXaWR0aCB8fCB0aGlzLm9mZnNldEhlaWdodCB8fCB0aGlzLmdldENsaWVudFJlY3RzKCkubGVuZ3RoKSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNob3coKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGlkZSgpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuQWRkQ2xhc3MgPSBmdW5jdGlvbiAoY2xhc3NOYW1lOiBzdHJpbmcpOiBFbGVtZW50IHtcclxuICAgIHRoaXMuY2xhc3NOYW1lICs9IGAgJHtjbGFzc05hbWV9YDtcclxuICAgIHRoaXMuY2xhc3NOYW1lID0gdGhpcy5jbGFzc05hbWUudHJpbSgpO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG5FbGVtZW50LnByb3RvdHlwZS5SZW1vdmVDbGFzcyA9IGZ1bmN0aW9uIChjbGFzc05hbWU6IHN0cmluZyk6IEVsZW1lbnQge1xyXG4gICAgdGhpcy5jbGFzc05hbWUgPSAoPHN0cmluZz50aGlzLmNsYXNzTmFtZSkucmVwbGFjZShjbGFzc05hbWUsICcnKS5ub3JtYWxpemUoKTtcclxuICAgIHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuRWxlbWVudC5wcm90b3R5cGUuQXNTdHJpbmcgPSBmdW5jdGlvbiAoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLm91dGVySFRNTDtcclxufTtcclxuXHJcbkVsZW1lbnQucHJvdG90eXBlLklzSGlkZGVuID0gZnVuY3Rpb24gKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICh0aGlzLm9mZnNldFBhcmVudCA9PT0gbnVsbCk7XHJcbn07XHJcblxyXG5IVE1MRWxlbWVudC5wcm90b3R5cGUuQ2xlYW4gPSBmdW5jdGlvbiAoKTogSFRNTEVsZW1lbnQge1xyXG4gICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWUucmVwbGFjZSgvXFxyP1xcbi9nLCAnXFxyXFxuJyk7XHJcbiAgICByZXR1cm4gdGhpcztcclxufTtcclxuXHJcbkhUTUxFbGVtZW50LnByb3RvdHlwZS5WYWx1ZSA9IGZ1bmN0aW9uICh2YWw/OiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaWYgKHZhbCAhPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubm9kZU5hbWUubG93ZXIoKSA9PT0gJ3RleHRhcmVhJykge1xyXG4gICAgICAgICAgICB0aGlzLmlubmVySFRNTCA9IHZhbDtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaW5uZXJUZXh0ID0gdmFsO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7IH1cclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWw7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlTmFtZS5sb3dlcigpID09PSAnaW5wdXQnKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy5hdHRyaWJ1dGUoJ3R5cGUnKS5sb3dlcigpKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdmaWxlJzpcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoPGJvb2xlYW4+PGFueT52YWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyYWRpbyc6XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWU6IHN0cmluZyA9IHRoaXMuYXR0cmlidXRlKCduYW1lJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJhZGlvczogTm9kZUxpc3RPZjxFbGVtZW50PiA9IGRvY3VtZW50LlNlbGVjdEFsbChgaW5wdXRbdHlwZT0ncmFkaW8nXVtuYW1lPScke25hbWV9J11gKTtcclxuICAgICAgICAgICAgICAgICAgICByYWRpb3MuRm9yRWFjaChmdW5jdGlvbiAoaWR4LCBlbGVtOiBFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLkF0dHJpYnV0ZSgndmFsdWUnKSA9PT0gdmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoPEhUTUxJbnB1dEVsZW1lbnQ+ZWxlbSkuY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoPEhUTUxJbnB1dEVsZW1lbnQ+ZWxlbSkuY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubm9kZU5hbWUubG93ZXIoKSA9PT0gJ3NlbGVjdCcpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9wdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnNbaV0udmFsdWUgPT09IHZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmICh0aGlzLm5vZGVOYW1lLmxvd2VyKCkgPT09ICd0ZXh0YXJlYScpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7IH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuaW5uZXJUZXh0ICE9IG51bGwgJiYgKDxzdHJpbmc+dGhpcy5pbm5lclRleHQpLnRyaW0oKSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlubmVyVGV4dDtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlubmVySFRNTCAhPSBudWxsICYmICg8c3RyaW5nPnRoaXMuaW5uZXJIVE1MKS50cmltKCkgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbm5lckhUTUw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm5vZGVOYW1lLmxvd2VyKCkgPT09ICdpbnB1dCcpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLmF0dHJpYnV0ZSgndHlwZScpLmxvd2VyKCkpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGVja2VkO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmFkaW8nOlxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuYW1lOiBzdHJpbmcgPSB0aGlzLmF0dHJpYnV0ZSgnbmFtZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQuU2VsZWN0T25lKGBpbnB1dFt0eXBlPSdyYWRpbyddW25hbWU9JyR7bmFtZX0nXTpjaGVja2VkYCkpLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlTmFtZS5sb3dlcigpID09PSAnc2VsZWN0Jykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zW3RoaXMuc2VsZWN0ZWRJbmRleF0udmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbDtcclxufTsiXX0=